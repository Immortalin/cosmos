%generate_query Relation Functor String String Functor Any;generate_chunk Relation Functor String String Any;notblank Relation Any;serialize_item Relation Functor String;make_runtime_binds Relation Any Any Any Any Any;make_binds Relation Any Any Any Any Any;make_bind Relation Any Any Any Any;generate_world Relation Any Any Any Any Any;generate_body Relation Functor Any Any Any Any;specialize_args Relation Any Any Any Any;specialize_type Relation Any Any Any Any Any;generate_cond Relation Any Any Any Any Any;stringfy_rel Relation String Any Any Any Any Any Any;make_runtime_temps Relation Any Any Any Any Any;make_lambdas Relation Any Any Any Any Any;make_lambda Relation Functor Integer Any Any String;generate_body Relation;stringfy_rel Relation;extract_list Relation Any String Any Any;extract_type_args_and_push_into_env Relation Any Any Any Any;extract_type_args Relation Any Any Any;extract_args Relation Any Any Any Any Any String;extract_type Relation Any Any Any;extract_name Relation Functor String Any Any String String;generate_lambda Relation Any Any Any Any;extract_list Relation;extract_ids Relation Any Any Any Any;extract_id Relation Any Any Any Any;escape_double_quotes Relation Any Any Any;is_relation Relation Any Any;is_functor Relation Any Any;is_type Relation Any Any Any;is_type2 Relation Any Any Any;make_this_string Relation Any Any Any Any;make_local_string Relation Any Any Any Any;compare_functor Relation Any Any Any Any;compare_relation Relation Any Any Any Any Any;id_var Relation Any Any;is_id Relation Any;specialize_args Relation Any Any Any Any;extract_args Relation;extract_type Relation;extract_type_args Relation;extract_modules Relation Any Any Any;extract_module Relation Any Any;find_lib Relation Any Any;env_get Relation Any Any;env_get_functor Relation Any Any Any;env_get_types Relation Any Any Any;env_has_var Relation Any Any;env_get_var Relation Any Any Any;_env_get_mod Relation Any Any Any;_env_get_var Relation Any Any Any;_env_get Relation Any Any;env_push_module Relation Any Any Any Any;env_set_lambdas Relation Any Any Any;env_push_lambda Relation Any Any Any;env_push_functor Relation Any Any Any;env_push Relation Any Any Any;env_modules Relation Any Any;env_lambdas Relation Any Any;env_functors Relation Any Any;env_vars Relation Any Any;env_init Relation Any Any Any Any;extract_type_information Relation String Functor;extract Relation Any Any;gensym Relation Any Any;custom_throw Relation Any Any;Info FunctorObject;Op FunctorObject;TList FunctorObject;Func FunctorObject;ObjGet FunctorObject;Id FunctorObject;Str FunctorObject;Num FunctorObject;Declaration FunctorObject;Once FunctorObject;Host FunctorObject;SoftCut FunctorObject;Cond FunctorObject;If FunctorObject;ObjPred FunctorObject;Bracket FunctorObject;Or FunctorObject;And FunctorObject;Pred FunctorObject;False FunctorObject;True FunctorObject;Inequality FunctorObject;Neq FunctorObject;Eq FunctorObject;Fact FunctorObject;Rel FunctorObject;Lib FunctorObject;Local FunctorObject;Var FunctorObject
:- style_check([-singleton,-no_effect]), ensure_loaded("core.pl").
gen1(Env0,_x,_y) :- eq(_x,fcVar(_y,_,_)).
gen0(Env0,_x) :- eq(_x,fcVar(_,"local", '[|]'(_t0,_))),neq(_t0,"FunctorObject").
:- ensure_loaded("lexer.pl").
:- ensure_loaded("parser.pl").
:- ensure_loaded("whitespacer.pl").
:- ensure_loaded("types.pl").
gen_custom_throw(Env0,_msg,_info) :- eq(_info,fcInfo(_line,_col)),obj_call2(Env0,"math","integerToString",[_line,T6]),string_concat("(line ",T6,T5),dynamic_add(T5,", col ",T4),obj_call2(Env0,"math","integerToString",[_col,T7]),dynamic_add(T4,T7,T3),dynamic_add(T3,") ",T2),dynamic_add(T2,_msg,T1),obj_call2(Env0,"logic","throw",[T1]).
gen_gensym(Env0,_prefix,_s) :- gensym(_prefix,_x),atom_string(_x,_s).
gen_extract(Env0,_s,_x) :- once(obj_call2(Env0,"string","find",[_s," ",_j])),obj_call2(Env0,"string","slice",[_s,0,_j,_name]),obj_call2(Env0,"string","size",[_s,T9]),fd_add(_j,1,T8),obj_call2(Env0,"string","slice",[_s,T8,T9,_stype]),obj_call2(Env0,"types","string_to_type",[_stype,_type]),eq(_x,fcVar(_name,"object",_type)).
gen_extract_type_information(Env0,_fname,_x) :- obj_call2(Env0,"io","open",[_fname,"read",_f]),obj_call2(Env0,"io","fileReadChar",[_f,_c]),(((neq(_c,"%")),string_concat("Warning: no type information on file ",_fname,T10),obj_call2(Env0,"io","writeln",[T10]),eq(_x,[]));(obj_call2(Env0,"io","fileReadLine",[_f,_line]),(((eq(_line,"")),string_concat("Warning: blank type information on file ",_fname,T11),obj_call2(Env0,"io","writeln",[T11]),eq(_x,[]));(obj_call2(Env0,"io","close",[_f]),once(obj_call2(Env0,"string","split",[_line,";",_l])),env_get(Env0,"extract",T12),obj_call2(Env0,"list","map",[_l,closure(T12,Env0),_l2]),eq(_x,_l2))))).
gen_env_init(Env0,_env,_vars,_fcs,_lambda) :- eq(_env,'[|]'(_vars,'[|]'(_fcs,'[|]'(_lambda,'[|]'([],[]))))).
gen_env_vars(Env0,_env,_x) :- eq(_env,'[|]'(_x,'[|]'(_,'[|]'(_,'[|]'(_,[]))))).
gen_env_functors(Env0,_env,_x) :- eq(_env,'[|]'(_,'[|]'(_x,'[|]'(_,'[|]'(_,[]))))).
gen_env_lambdas(Env0,_env,_x) :- eq(_env,'[|]'(_,'[|]'(_,'[|]'(_x,'[|]'(_,[]))))).
gen_env_modules(Env0,_env,_x) :- eq(_env,'[|]'(_,'[|]'(_,'[|]'(_,'[|]'(_x,[]))))).
gen_env_push(Env0,_env,_f,_env2) :- eq(_env,'[|]'(_vars,'[|]'(_fcs,'[|]'(_lambda,'[|]'(_mods,[]))))),eq(_env2,'[|]'( '[|]'(_f,_vars),'[|]'(_fcs,'[|]'(_lambda,'[|]'(_mods,[]))))).
gen_env_push_functor(Env0,_env,_f,_env2) :- eq(_env,'[|]'(_vars,'[|]'(_fcs,'[|]'(_lambda,'[|]'(_mods,[]))))),eq(_env2,'[|]'(_vars,'[|]'( '[|]'(_f,_fcs),'[|]'(_lambda,'[|]'(_mods,[]))))).
gen_env_push_lambda(Env0,_env,_f,_env2) :- eq(_env,'[|]'(_vars,'[|]'(_fcs,'[|]'(_lambda,'[|]'(_mods,[]))))),eq(_env2,'[|]'(_vars,'[|]'(_fcs,'[|]'( '[|]'(_f,_lambda),'[|]'(_mods,[]))))).
gen_env_set_lambdas(Env0,_env,_lambdas,_env2) :- eq(_env,'[|]'(_vars,'[|]'(_fcs,'[|]'(_,'[|]'(_mods,[]))))),eq(_env2,'[|]'(_vars,'[|]'(_fcs,'[|]'(_lambdas,'[|]'(_mods,[]))))).
gen_env_push_module(Env0,_env,_mod,_type_info,_env2) :- eq(_env,'[|]'(_vars,'[|]'(_fcs,'[|]'(_lambda,'[|]'(_mods,[]))))),eq(_env2,'[|]'(_vars,'[|]'(_fcs,'[|]'(_lambda,'[|]'( '[|]'('[|]'(_mod,'[|]'(_type_info,[])),_mods),[]))))).
gen__env_get(Env0,_env,_f) :- eq(_env, '[|]'(_head,_)),eq(_head,_f);eq(_env, '[|]'(_,_tail)),env_call(Env0,"_env_get",[Env0,_tail,_f]).
gen__env_get_var(Env0,_env,_a,_f) :- eq(_env, '[|]'(_head,_)),eq(_head,fcVar(_a,_,_)),eq(_f,_head);eq(_env, '[|]'(_,_tail)),env_call(Env0,"_env_get_var",[Env0,_tail,_a,_f]).
gen__env_get_mod(Env0,_env,_a,_b) :- eq(_env, '[|]'(_head,_)),eq(_head,'[|]'(_a,'[|]'(_b,[])));eq(_env, '[|]'(_,_tail)),env_call(Env0,"_env_get_mod",[Env0,_tail,_a,_b]).
gen_env_get_var(Env0,_env,_a,_f) :- env_call(Env0,"env_vars",[Env0,_env,_vars]),env_call(Env0,"_env_get_var",[Env0,_vars,_a,_f]).
gen_env_has_var(Env0,_env,_f) :- env_call(Env0,"env_vars",[Env0,_env,_vars]),obj_call2(Env0,"list","has",[_vars,_f]).
gen_env_get_types(Env0,_env,_obj,_types) :- env_call(Env0,"env_modules",[Env0,_env,_mods]),env_call(Env0,"_env_get_mod",[Env0,_mods,_obj,_types]).
gen_env_get_functor(Env0,_env,_a,_f) :- env_call(Env0,"env_functors",[Env0,_env,_fcs]),env_call(Env0,"_env_get_var",[Env0,_fcs,_a,_f]).
gen_env_get(Env0,_env,_f) :- env_call(Env0,"env_vars",[Env0,_env,_vars]),env_call(Env0,"_env_get",[Env0,_vars,_f]).
gen_find_lib(Env0,_env,_obj_name) :- env_call(Env0,"env_vars",[Env0,_env,T13]),obj_call2(Env0,"list","find",[T13,fcLib(_,_obj_name),_]).
gen_extract_module(Env0,_name,_ts) :- dynamic_add(_name,".pl",T14),env_call(Env0,"extract_type_information",[Env0,T14,_ts]).
gen_extract_modules(Env0,_env,_l,_env2) :- (((eq(_l, '[|]'(_name,_l2))),env_call(Env0,"extract_module",[Env0,_name,_ts]),env_call(Env0,"env_push_module",[Env0,_env,_name,_ts,_env_a]),env_call(Env0,"extract_modules",[Env0,_env_a,_l2,_env2]));(eq(_env2,_env))).
gen_is_id(Env0,_x) :- eq(_x,fcId(_,_)).
gen_id_var(Env0,_x,_y) :- eq(_x,fcId(_name,_t)),eq(_y,fcVar(_name,"local",_t)).
gen_compare_relation(Env0,_fvar,_args,_env,_env2,_info) :- eq(_fvar,fcVar(_name,_,_t1)),env_call(Env0,"extract_type_args",[Env0,_args,_targs,_env]),env_call(Env0,"specialize_args",[Env0,_args,_targs,_env,_env2]),eq(_t2, '[|]'("Relation",_targs)),(((obj_call2(Env0,"types","compare_types",[_t1,_t2])),true);(string_concat("calling relation \"",_name,T20),dynamic_add(T20,"\" of type \"",T19),obj_call2(Env0,"types","type_to_string",[_t1,T21]),dynamic_add(T19,T21,T18),dynamic_add(T18,"\" as \"",T17),obj_call2(Env0,"types","type_to_string",[_t2,T22]),dynamic_add(T17,T22,T16),dynamic_add(T16,"\"",T15),eq(_msg,T15),env_call(Env0,"custom_throw",[Env0,_msg,_info]))).
gen_compare_functor(Env0,_var_fc,_args,_env,_info) :- eq(_var_fc,fcVar(_name,_,_t1)),env_call(Env0,"extract_type_args",[Env0,_args,_targs,_env]),eq(_t2, '[|]'("Functor",_targs)),(((obj_call2(Env0,"types","compare_types",[_t1,_t2])),true);(string_concat("using functor ",_name,T28),dynamic_add(T28," of type \"",T27),obj_call2(Env0,"types","type_to_string",[_t1,T29]),dynamic_add(T27,T29,T26),dynamic_add(T26,"\" as \"",T25),obj_call2(Env0,"types","type_to_string",[_t2,T30]),dynamic_add(T25,T30,T24),dynamic_add(T24,"\"",T23),eq(_msg,T23),env_call(Env0,"custom_throw",[Env0,_msg,_info]))).
gen_make_local_string(Env0,_prefix,_name,_sargs,_code) :- dynamic_add(_prefix,"closure_call(Env0,_",T36),dynamic_add(T36,_name,T35),dynamic_add(T35,",",T34),dynamic_add(T34,"[",T33),dynamic_add(T33,_sargs,T32),dynamic_add(T32,"])",T31),eq(_code,T31).
gen_make_this_string(Env0,_prefix,_name,_sargs,_code) :- string_concat("env_call(Env0,\"",_name,T38),dynamic_add(T38,"\",",T37),eq(_s1,T37),(((eq(_sargs,"")),eq(_s2,"[Env0])"));(string_concat("[Env0,",_sargs,T40),dynamic_add(T40,"])",T39),eq(_s2,T39))),dynamic_add(_prefix,_s1,T42),dynamic_add(T42,_s2,T41),eq(_code,T41).
gen_is_type2(Env0,_a,_type,_env) :- eq(_env, '[|]'(_head,_)),eq(_head,fcVar(_a,_, '[|]'(_type,_)));eq(_env, '[|]'(_,_tail)),env_call(Env0,"is_type2",[Env0,_a,_type,_tail]).
gen_is_type(Env0,_a,_type,_env) :- env_call(Env0,"env_vars",[Env0,_env,T43]),env_call(Env0,"is_type2",[Env0,_a,_type,T43]).
gen_is_functor(Env0,_a,_env) :- env_call(Env0,"is_type",[Env0,_a,"FunctorObject",_env]).
gen_is_relation(Env0,_a,_env) :- env_call(Env0,"is_type",[Env0,_a,"Relation",_env]).
gen_escape_double_quotes(Env0,_s1,_c_prev,_s2) :- eq(_s1,""),eq(_s2,_s1);obj_call2(Env0,"string","at",[_s1,0,_c]),eq(_c,"\""),neq(_c_prev,"\\"),obj_call2(Env0,"string","rest",[_s1,_tail]),env_call(Env0,"escape_double_quotes",[Env0,_tail,_c,_s_next]),obj_call2(Env0,"string","concat",["\\","\"",_ctemp]),obj_call2(Env0,"string","concat",[_ctemp,_s_next,_s2]);obj_call2(Env0,"string","rest",[_s1,_tail]),obj_call2(Env0,"string","at",[_s1,0,_c]),env_call(Env0,"escape_double_quotes",[Env0,_tail,_c,_s_next]),obj_call2(Env0,"string","concat",[_c,_s_next,_s2]).
gen_extract_id(Env0,_f,_s2,_env,_prefix) :- eq(_f,fcId(_s1,_)),eq(_prefix,""),string_concat("_",_s1,T44),eq(_s2,T44).
gen_extract_ids(Env0,_l,_s,_env,_prefix) :- eq(_l, '[|]'(_f1,[])),env_call(Env0,"extract_id",[Env0,_f1,_s,_env,_prefix]);eq(_l, '[|]'(_f1,_tail)),env_call(Env0,"extract_id",[Env0,_f1,_s1,_env,_prefix2]),env_call(Env0,"extract_ids",[Env0,_tail,_s2,_env,_prefix1]),obj_call2(Env0,"string","concat",[_prefix1,_prefix2,_prefix]),dynamic_add(_s1,",",T46),dynamic_add(T46,_s2,T45),eq(_s,T45);eq(_l,[]),eq(_s,""),eq(_prefix,"").
gen_generate_lambda(Env0,_code,_prefix,_temp_functions,_module) :- obj_call2(Env0,"list","size",[_temp_functions,_len1]),string_concat("closure(",_module,T49),obj_call2(Env0,"math","integerToString",[_len1,T50]),dynamic_add(T49,T50,T48),dynamic_add(T48,",Env0)",T47),eq(_code,T47),eq(_prefix,"").
gen_extract_name(Env0,_f,_s2,_env,_env2,_prefix,_module) :- (((eq(_f,fcId(_name,_))),eq(_env,_env2),(((eq(_name,"Cons")),eq(_prefix,""),eq(_s2,"[]"));((eq(_name,"_")),eq(_prefix,""),eq(_s2,"_"));((env_call(Env0,"is_functor",[Env0,_name,_env])),eq(_prefix,""),string_concat("fc",_name,T51),eq(_s2,T51));((env_call(Env0,"env_get_var",[Env0,_env,_name,fcVar(_name,_loc,_type)])),(((eq(_loc,"object")),env_call(Env0,"gensym",[Env0,"T",_c]),string_concat("env_get(Env0,\"",_name,T55),dynamic_add(T55,"\",",T54),dynamic_add(T54,_c,T53),dynamic_add(T53,"),",T52),eq(_prefix,T52),string_concat("closure(",_c,T57),dynamic_add(T57,",Env0)",T56),eq(_s2,T56));(eq(_prefix,""),string_concat("_",_name,T58),eq(_s2,T58))));((env_call(Env0,"env_has_var",[Env0,_env,fcLib(_,_name)])),env_call(Env0,"gensym",[Env0,"T",_c]),string_concat("env_get(Env0,\"",_name,T62),dynamic_add(T62,"\",",T61),dynamic_add(T61,_c,T60),dynamic_add(T60,"),",T59),eq(_prefix,T59),eq(_s2,_c));(eq(_prefix,""),string_concat("_",_name,T63),eq(_s2,T63))));((eq(_f,fcNum(_s))),eq(_env,_env2),(((obj_call2(Env0,"string","has",[_s,"."])),eq(_s2,_s));(string_concat("",_s,T64),eq(_s2,T64))),eq(_prefix,""));((eq(_f,fcOp(_a,_b,_op,_info))),eq(_env,_env2),env_call(Env0,"gensym",[Env0,"T",_c]),eq(_s2,_c),env_call(Env0,"extract_type",[Env0,_a,_ta,_env]),env_call(Env0,"extract_type",[Env0,_b,_tb,_env]),(((obj_call2(Env0,"types","compare_types",[_ta,_tb])),true);(string_concat("using operator \"",_op,T70),dynamic_add(T70,"\" on types \"",T69),obj_call2(Env0,"types","type_to_string",[_ta,T71]),dynamic_add(T69,T71,T68),dynamic_add(T68,"\" and \"",T67),obj_call2(Env0,"types","type_to_string",[_tb,T72]),dynamic_add(T67,T72,T66),dynamic_add(T66,"\" (values must have the same type)",T65),env_call(Env0,"custom_throw",[Env0,T65,_info]))),(((eq(_ta,'[|]'("Number",[]));eq(_ta,'[|]'("Integer",[]))),eq(_sop,"fd_"));((eq(_ta,'[|]'("Real",[]))),eq(_sop,"r_"));((eq(_tb,'[|]'("Number",[]));eq(_tb,'[|]'("Integer",[]))),eq(_sop,"fd_"));((eq(_tb,'[|]'("Real",[]))),eq(_sop,"r_"));(eq(_sop,""))),(((eq(_sop,"")),(((eq(_op,"+")),(((eq(_ta,'[|]'("Any",[]))),eq(_fn,"dynamic_add"));(eq(_fn,"string_concat"))));((((eq(_ta,'[|]'("Any",[]))),env_call(Env0,"custom_throw",[Env0,"cannot infer type",_info]));(string_concat("cannot use operator \"",_op,T74),dynamic_add(T74,"\" (value is not a number)",T73),env_call(Env0,"custom_throw",[Env0,T73,_info]))))));((eq(_op,"/")),string_concat(_sop,"div",T75),eq(_fn,T75));((eq(_op,"*")),string_concat(_sop,"mul",T76),eq(_fn,T76));((eq(_op,"+")),string_concat(_sop,"add",T77),eq(_fn,T77));((eq(_op,"-")),string_concat(_sop,"sub",T78),eq(_fn,T78))),env_call(Env0,"extract_name",[Env0,_a,_sa,_env,_,_prefix1,_module]),env_call(Env0,"extract_name",[Env0,_b,_sb,_env,_,_prefix2,_module]),dynamic_add(_prefix1,_prefix2,T87),dynamic_add(T87,_fn,T86),dynamic_add(T86,"(",T85),dynamic_add(T85,_sa,T84),dynamic_add(T84,",",T83),dynamic_add(T83,_sb,T82),dynamic_add(T82,",",T81),dynamic_add(T81,_c,T80),dynamic_add(T80,"),",T79),eq(_prefix,T79));((eq(_f,fcStr(_sa))),eq(_env,_env2),eq(_prefix,""),obj_call2(Env0,"string","size",[_sa,T89]),fd_sub(T89,1,T88),obj_call2(Env0,"string","slice",[_sa,1,T88,_sb]),env_call(Env0,"escape_double_quotes",[Env0,_sb,"",_sc]),string_concat("\"",_sc,T91),dynamic_add(T91,"\"",T90),eq(_s2,T90));((eq(_f,fcObjGet(_a,_b))),eq(_env,_env2),env_call(Env0,"gensym",[Env0,"T",_c]),(((eq(_a,"this")),string_concat("env_get(Env0,\"",_b,T95),dynamic_add(T95,"\",",T94),dynamic_add(T94,_c,T93),dynamic_add(T93,"),",T92),eq(_prefix,T92));(string_concat("obj_get(Env0,\"",_a,T101),dynamic_add(T101,"\",\"",T100),dynamic_add(T100,_b,T99),dynamic_add(T99,"\",",T98),dynamic_add(T98,_c,T97),dynamic_add(T97,"),",T96),eq(_prefix,T96))),string_concat("closure(",_c,T103),dynamic_add(T103,",Env0)",T102),eq(_s2,T102));((eq(_f,fcFunc(_name,_args,_info))),(((eq(_name,"Cons")),env_call(Env0,"extract_args",[Env0,_args,_sb,_env,_env2,_prefix,_module]),obj_call2(Env0,"string","code",[_c,39]),string_concat(" ",_c,T109),dynamic_add(T109,"[|]",T108),dynamic_add(T108,_c,T107),dynamic_add(T107,"(",T106),dynamic_add(T106,_sb,T105),dynamic_add(T105,")",T104),eq(_s2,T104));((env_call(Env0,"is_functor",[Env0,_name,_env])),eq(_env,_env2),env_call(Env0,"extract_args",[Env0,_args,_sargs,_env,_,_prefix,_module]),string_concat("fc",_name,T113),dynamic_add(T113,"(",T112),dynamic_add(T112,_sargs,T111),dynamic_add(T111,")",T110),eq(_s2,T110));((env_call(Env0,"is_relation",[Env0,_name,_env])),(((env_call(Env0,"env_get_var",[Env0,_env,_name,_fvar])),obj_call2(Env0,"list","concat",[_args,'[|]'("Any",[]),_args2]),env_call(Env0,"compare_relation",[Env0,_fvar,_args2,_env,_,_info]));(obj_call2(Env0,"string","concat",["cannot find relation ",_name,_msg]))),env_call(Env0,"gensym",[Env0,"T",_s2]),env_call(Env0,"extract_args",[Env0,_args,_sargs,_env,_env2,_prefix1,_module]),(((obj_call2(Env0,"list","size",[_args,T114]),eq(T114,0)),dynamic_add(_sargs,_s2,T115),eq(_sargs2,T115));(dynamic_add(_sargs,",",T117),dynamic_add(T117,_s2,T116),eq(_sargs2,T116))),(((eq(_fvar,fcVar(_,"local",_))),env_call(Env0,"make_local_string",[Env0,"",_name,_sargs2,_prefix2]));((eq(_fvar,fcVar(_,"args",_))),env_call(Env0,"make_local_string",[Env0,"",_name,_sargs2,_prefix2]));(env_call(Env0,"make_this_string",[Env0,"",_name,_sargs2,_prefix2]))),dynamic_add(_prefix1,_prefix2,T119),dynamic_add(T119,",",T118),eq(_prefix,T118));(string_concat("cannot call variable of unknown type: ",_name,T120),eq(_msg,T120),env_call(Env0,"custom_throw",[Env0,_msg,_info]))));((eq(_f,fcFunc(_obj,_name,_args,_info))),(((env_call(Env0,"env_get_types",[Env0,_env,_obj,_ts]),neq(_ts,[])),(((env_call(Env0,"_env_get_var",[Env0,_ts,_name,_fvar])),obj_call2(Env0,"list","concat",[_args,'[|]'("Any",[]),_args2]),env_call(Env0,"compare_relation",[Env0,_fvar,_args2,_env,_,_info]),eq(_env,_env_a));(string_concat("cannot find relation ",_name,T123),dynamic_add(T123," in module ",T122),dynamic_add(T122,_obj,T121),env_call(Env0,"custom_throw",[Env0,T121,_info]))));(eq(_env,_env_a))),env_call(Env0,"gensym",[Env0,"T",_s2]),env_call(Env0,"extract_args",[Env0,_args,_sargs,_env_a,_env2,_prefix1,_module]),(((obj_call2(Env0,"list","size",[_args,T124]),eq(T124,0)),dynamic_add(_sargs,_s2,T125),eq(_sargs2,T125));(dynamic_add(_sargs,",",T127),dynamic_add(T127,_s2,T126),eq(_sargs2,T126))),string_concat("obj_call2(Env0,\"",_obj,T135),dynamic_add(T135,"\",",T134),dynamic_add(T134,"\"",T133),dynamic_add(T133,_name,T132),dynamic_add(T132,"\",",T131),dynamic_add(T131,"[",T130),dynamic_add(T130,_sargs2,T129),dynamic_add(T129,"]),",T128),eq(_prefix2,T128),dynamic_add(_prefix1,_prefix2,T136),eq(_prefix,T136));((eq(_f,fcTList(_args))),eq(_env,_env2),env_call(Env0,"extract_list",[Env0,_args,_sargs,_env,_prefix]),eq(_s2,_sargs));((eq(_f,fcRel(_args1,_body1))),env_call(Env0,"env_lambdas",[Env0,_env,T137]),env_call(Env0,"generate_lambda",[Env0,_s2,_prefix,T137,_module]),env_call(Env0,"env_push_lambda",[Env0,_env,fcRel("",_args1,_body1),_env2]))).
gen_extract_type(Env0,_f,_type,_env) :- (((eq(_f,fcNum(_s))),(((obj_call2(Env0,"string","has",[_s,"."])),eq(_type,'[|]'("Real",[])));(eq(_type,'[|]'("Integer",[])))));((eq(_f,fcStr(_))),eq(_type,'[|]'("String",[])));((eq(_f,fcId(_name,_type_id))),(((neq(_type_id,[])),eq(_type_id, '[|]'(_type_name,_)),(((obj_call2(Env0,"list","has",['[|]'("Any",'[|]'("Number",'[|]'("Integer",'[|]'("Real",'[|]'("Functor",'[|]'("Relation",'[|]'("String",'[|]'("Record",'[|]'("File",[]))))))))),_type_name])),eq(_type,_type_id));(string_concat("\"",_type_name,T139),dynamic_add(T139,"\" is not a type",T138),obj_call2(Env0,"logic","throw",[T138]))));((env_call(Env0,"env_get",[Env0,_env,_fvar])),eq(_fvar,fcVar(_name,_,_type_var)),(((eq(_type_var,[])),eq(_type,'[|]'("Any",[])));((eq(_type_var,'[|]'("FunctorObject",[]))),env_call(Env0,"env_get_functor",[Env0,_env,_name,_fc_var]),eq(_fc_var,fcVar(_,_,_type)));(eq(_type,_type_var))));((env_call(Env0,"env_has_var",[Env0,_env,fcLib(_,_name)])),eq(_type,'[|]'("Record",[])));(eq(_type,'[|]'("Any",[])))));((eq(_f,fcFunc(_name,_args,_info))),env_call(Env0,"is_type",[Env0,_name,_ftype,_env]),(((eq(_ftype,"FunctorObject")),env_call(Env0,"extract_type_args",[Env0,_args,_targs,_env]),eq(_type, '[|]'("Functor",_targs)),env_call(Env0,"env_get_functor",[Env0,_env,_name,_var_fc]),env_call(Env0,"compare_functor",[Env0,_var_fc,_args,_env,_info]));(eq(_ftype,"Relation"),env_call(Env0,"env_get_var",[Env0,_env,_name,_fvar]),eq(_fvar,fcVar(_,_,_t1)),obj_call2(Env0,"list","last",[_t1,_type]))));((eq(_f,fcFunc(_obj,_name,_args,_info))),(((env_call(Env0,"env_get_types",[Env0,_env,_obj,_ts]),neq(_ts,[])),env_call(Env0,"_env_get_var",[Env0,_ts,_name,_fvar]),eq(_fvar,fcVar(_,_,_t1)),obj_call2(Env0,"list","concat",[_args,'[|]'("Any",[]),_args2]),obj_call2(Env0,"list","last",[_t1,_type]));(eq(_type,'[|]'("Any",[])))));((eq(_f,fcRel(_args,_))),env_call(Env0,"extract_type_args",[Env0,_args,_targs,_env]),eq(_type, '[|]'("Relation",_targs)));((eq(_f,fcOp(_a,_b,_op,_info))),eq(_type,'[|]'("Any",[])));((eq(_f,fcTList(_))),eq(_type,'[|]'("Functor",[])));(eq(_type,'[|]'("Any",[])))).
gen_extract_args(Env0,_l,_s,_env,_env2,_prefix,_module) :- (((eq(_l, '[|]'(_f1,[]))),env_call(Env0,"extract_name",[Env0,_f1,_s,_env,_env2,_prefix,_module]));((eq(_l, '[|]'(_f1,_tail))),env_call(Env0,"extract_name",[Env0,_f1,_s1,_env,_env_a,_prefix2,_module]),env_call(Env0,"extract_args",[Env0,_tail,_s2,_env_a,_env2,_prefix1,_module]),obj_call2(Env0,"string","concat",[_prefix1,_prefix2,_prefix]),dynamic_add(_s1,",",T141),dynamic_add(T141,_s2,T140),eq(_s,T140));(eq(_l,[]),eq(_s,""),eq(_prefix,""),eq(_env2,_env))).
gen_extract_type_args(Env0,_l,_ts,_env) :- eq(_l, '[|]'(_f1,[])),eq(_ts, '[|]'(_t,[])),env_call(Env0,"extract_type",[Env0,_f1,_t,_env]);eq(_l, '[|]'(_f1,_tail)),eq(_ts, '[|]'(_t1,_t2)),env_call(Env0,"extract_type",[Env0,_f1,_t1,_env]),env_call(Env0,"extract_type_args",[Env0,_tail,_t2,_env]);eq(_l,[]),eq(_ts,[]).
gen_extract_type_args_and_push_into_env(Env0,_l,_ts,_env,_env2) :- eq(_l, '[|]'(_f1,[])),eq(_ts, '[|]'(_t,[])),eq(_f1,fcId(_name,_)),env_call(Env0,"env_init",[Env0,_env0,[],[],[]]),env_call(Env0,"extract_type",[Env0,_f1,_t,_env0]),env_call(Env0,"env_push",[Env0,_env,fcVar(_name,"args",_t),_env2]);eq(_l, '[|]'(_f1,_tail)),eq(_ts, '[|]'(_t1,_t2)),eq(_f1,fcId(_name,_)),env_call(Env0,"env_init",[Env0,_env0,[],[],[]]),env_call(Env0,"extract_type",[Env0,_f1,_t1,_env0]),env_call(Env0,"extract_type_args_and_push_into_env",[Env0,_tail,_t2,_env,_env_1]),env_call(Env0,"env_push",[Env0,_env_1,fcVar(_name,"args",_t1),_env2]);eq(_l,[]),eq(_ts,[]),eq(_env2,_env).
gen_extract_list(Env0,_l,_s,_env,_prefix) :- (((eq(_l, '[|]'(_f1,_tail))),env_call(Env0,"extract_name",[Env0,_f1,_sa,_env,_,_prefix1,_module]),env_call(Env0,"extract_list",[Env0,_tail,_sb,_env,_prefix2]),dynamic_add(_prefix1,_prefix2,T142),eq(_prefix,T142),obj_call2(Env0,"string","code",[_c,39]),dynamic_add(_c,"[|]",T144),dynamic_add(T144,_c,T143),eq(_symbol,T143),string_concat("",_symbol,T150),dynamic_add(T150,"(",T149),dynamic_add(T149,_sa,T148),dynamic_add(T148,",",T147),dynamic_add(T147,_sb,T146),dynamic_add(T146,")",T145),eq(_s,T145));(eq(_l,[]),eq(_s,"[]"),eq(_prefix,""))).
gen_make_lambda(Env0,_fc,_i,_code,_env,_module) :- eq(_fc,fcRel(_,_args,_f1)),env_call(Env0,"extract_type_args_and_push_into_env",[Env0,_args,_type,_env,_env_a]),obj_call2(Env0,"math","integerToString",[_i,T152]),string_concat(_module,T152,T151),eq(_name,T151),env_call(Env0,"stringfy_rel",[Env0,_name,_args,_f1,_code,_env_a,_,_module]).
gen_make_lambdas(Env0,_l,_l2,_i,_env,_module) :- (((eq(_l,[])),eq(_l2,[]));(eq(_l, '[|]'(_a,_b)),env_call(Env0,"make_lambda",[Env0,_a,_i,_a2,_env,_module]),eq(_l2, '[|]'(_a2,_b2)),fd_sub(_i,1,T153),env_call(Env0,"make_lambdas",[Env0,_b,_b2,T153,_env,_module]))).
gen_make_runtime_temps(Env0,_l,_l2,_i,_env,_module) :- (((eq(_l,[])),eq(_l2,[]));(eq(_l, '[|]'(_a,_b)),env_call(Env0,"make_lambda",[Env0,_a,_i,_a2,_env,_module]),string_concat("assert(",_a2,T155),dynamic_add(T155,")",T154),eq(_l2, '[|]'(T154,_b2)),obj_call2(Env0,"math","sub",[_i,1,_j]),env_call(Env0,"make_lambdas",[Env0,_b,_b2,_j,_env,_module]))).
gen_stringfy_rel(Env0,_name,_args,_f1,_code,_env,_lambdas,_module) :- env_call(Env0,"generate_body",[Env0,_f1,_sbody,_env,_env_a,_module]),env_call(Env0,"extract_ids",[Env0,_args,_sargs,_env,_]),(((eq(_args,[])),eq(_sa,"Env0"));(eq(_sa,"Env0,"))),env_call(Env0,"env_lambdas",[Env0,_env_a,_lambdas]),string_concat("",_name,T160),dynamic_add(T160,"(",T159),dynamic_add(T159,_sa,T158),dynamic_add(T158,_sargs,T157),dynamic_add(T157,") :- ",T156),eq(_header,T156),dynamic_add(_header,_sbody,T162),dynamic_add(T162,".\n",T161),eq(_code,T161).
gen_generate_cond(Env0,_l,_code,_env,_env2,_module) :- (((eq(_l, '[|]'(_c, '[|]'(_d,_l2)))),env_call(Env0,"generate_body",[Env0,_c,_sc,_env,_env_a,_module]),env_call(Env0,"generate_body",[Env0,_d,_sd,_env_a,_env_b,_module]),string_concat("((",_sc,T166),dynamic_add(T166,"),",T165),dynamic_add(T165,_sd,T164),dynamic_add(T164,")",T163),eq(_s2,T163),(((eq(_l2,[])),eq(_code,_s2),eq(_env2,_env_b));(env_call(Env0,"generate_cond",[Env0,_l2,_code1,_env_b,_env2,_module]),dynamic_add(_s2,";",T168),dynamic_add(T168,_code1,T167),eq(_code,T167))));((eq(_l, '[|]'(_c,[]))),env_call(Env0,"generate_body",[Env0,_c,_sc,_env,_env2,_module]),string_concat("(",_sc,T170),dynamic_add(T170,")",T169),eq(_code,T169));((eq(_l,[])),eq(_code,"true"),eq(_env2,_env))).
gen_specialize_type(Env0,_env,_a,_ta,_tb,_env2) :- (((eq(_a,fcId(_name,_))),(((obj_call2(Env0,"types","strict_type",[_ta,_tb,_tc])),env_call(Env0,"env_push",[Env0,_env,fcVar(_name,"local",_tc),_env2]));(obj_call2(Env0,"io","writeln",['[|]'(_ta,'[|]'(_tb,[]))]),obj_call2(Env0,"logic","throw",["no strict"]))));(eq(_env2,_env))).
gen_specialize_args(Env0,_l,_ts,_env,_env2) :- (((eq(_l,[])),eq(_env2,_env));(eq(_l, '[|]'(_a,_l2)),eq(_ts, '[|]'(_tb,_ts2)),env_call(Env0,"extract_type",[Env0,_a,_ta,_env]),env_call(Env0,"specialize_type",[Env0,_env,_a,_ta,_tb,_env_a]),env_call(Env0,"specialize_args",[Env0,_l2,_ts2,_env_a,_env2]))).
gen_generate_body(Env0,_f,_code,_env,_env2,_module) :- (((eq(_f,fcAnd(_a,_b))),env_call(Env0,"generate_body",[Env0,_a,_s1,_env,_temp,_module]),env_call(Env0,"generate_body",[Env0,_b,_s2,_temp,_env2,_module]),dynamic_add(_s1,",",T172),dynamic_add(T172,_s2,T171),eq(_code,T171));((eq(_f,fcOr(_a,_b))),env_call(Env0,"generate_body",[Env0,_a,_s1,_env,_env_a,_module]),env_call(Env0,"generate_body",[Env0,_b,_s2,_env_a,_env2,_module]),dynamic_add(_s1,";",T174),dynamic_add(T174,_s2,T173),eq(_code,T173));((eq(_f,fcBracket(_f1))),env_call(Env0,"generate_body",[Env0,_f1,_code0,_env,_env2,_module]),string_concat("(",_code0,T176),dynamic_add(T176,")",T175),eq(_code,T175));((eq(_f,fcEq(_a,_b,_info))),env_call(Env0,"extract_name",[Env0,_a,_sa,_env,_env_a,_prefix1,_module]),env_call(Env0,"extract_name",[Env0,_b,_sb,_env_a,_env_b,_prefix2,_module]),env_call(Env0,"extract_type",[Env0,_a,_ta,_env]),env_call(Env0,"extract_type",[Env0,_b,_tb,_env]),(((obj_call2(Env0,"types","compare_types",[_ta,_tb])),string_concat("",_prefix1,T183),dynamic_add(T183,_prefix2,T182),dynamic_add(T182,"eq(",T181),dynamic_add(T181,_sa,T180),dynamic_add(T180,",",T179),dynamic_add(T179,_sb,T178),dynamic_add(T178,")",T177),eq(_code,T177),env_call(Env0,"specialize_type",[Env0,_env_b,_a,_ta,_tb,_env_c]),env_call(Env0,"specialize_type",[Env0,_env_c,_b,_tb,_ta,_env2]));(obj_call2(Env0,"types","type_to_string",[_ta,T188]),string_concat("cannot unify type \"",T188,T187),dynamic_add(T187,"\" with type \"",T186),obj_call2(Env0,"types","type_to_string",[_tb,T189]),dynamic_add(T186,T189,T185),dynamic_add(T185,"\"",T184),env_call(Env0,"custom_throw",[Env0,T184,_info]))));((eq(_f,fcInequality(_a,_b,_op,_info))),env_call(Env0,"extract_name",[Env0,_a,_sa,_env,_env_a,_prefix1,_module]),env_call(Env0,"extract_name",[Env0,_b,_sb,_env_a,_env_b,_prefix2,_module]),env_call(Env0,"extract_type",[Env0,_a,_ta,_env]),env_call(Env0,"extract_type",[Env0,_b,_tb,_env]),(((eq(_ta,'[|]'("Number",[]));eq(_tb,'[|]'("Number",[]));obj_call2(Env0,"types","compare_types",[_ta,_tb])),(((eq(_op,"=")),string_concat("",_prefix1,T196),dynamic_add(T196,_prefix2,T195),dynamic_add(T195,"eq(",T194),dynamic_add(T194,_sa,T193),dynamic_add(T193,",",T192),dynamic_add(T192,_sb,T191),dynamic_add(T191,")",T190),eq(_code,T190));((((eq(_op,"!=")),eq(_fn,"neq"));((eq(_op,"<")),eq(_fn,"lt"));((eq(_op,"<=")),eq(_fn,"le"));((eq(_op,">")),eq(_fn,"gt"));((eq(_op,">=")),eq(_fn,"ge"))),(((eq(_ta,'[|]'("Integer",[]));eq(_ta,'[|]'("Number",[]))),eq(_s_op,"fd"));((eq(_ta,'[|]'("Real",[]))),eq(_s_op,"r"));((eq(_tb,'[|]'("Integer",[]));eq(_tb,'[|]'("Number",[]))),eq(_s_op,"fd"));((eq(_tb,'[|]'("Real",[]))),eq(_s_op,"r"));((((eq(_op,"!=")),eq(_s_op,""));((((eq(_ta,'[|]'("Any",[]))),env_call(Env0,"custom_throw",[Env0,"cannot infer type",_info]));(env_call(Env0,"custom_throw",[Env0,"not a number",_info]))))))),(((eq(_s_op,"")),string_concat("",_prefix1,T204),dynamic_add(T204,_prefix2,T203),dynamic_add(T203,_fn,T202),dynamic_add(T202,"(",T201),dynamic_add(T201,_sa,T200),dynamic_add(T200,",",T199),dynamic_add(T199,_sb,T198),dynamic_add(T198,")",T197),eq(_code,T197));(string_concat("",_prefix1,T214),dynamic_add(T214,_prefix2,T213),dynamic_add(T213,_s_op,T212),dynamic_add(T212,"_",T211),dynamic_add(T211,_fn,T210),dynamic_add(T210,"(",T209),dynamic_add(T209,_sa,T208),dynamic_add(T208,",",T207),dynamic_add(T207,_sb,T206),dynamic_add(T206,")",T205),eq(_code,T205))))),env_call(Env0,"specialize_type",[Env0,_env_b,_a,_ta,_tb,_env_c]),env_call(Env0,"specialize_type",[Env0,_env_c,_b,_tb,_ta,_env2]));(obj_call2(Env0,"types","type_to_string",[_ta,T219]),string_concat("cannot compare type \"",T219,T218),dynamic_add(T218,"\" with type \"",T217),obj_call2(Env0,"types","type_to_string",[_tb,T220]),dynamic_add(T217,T220,T216),dynamic_add(T216,"\"",T215),env_call(Env0,"custom_throw",[Env0,T215,_info]))));((eq(_f,fcRel(_name,_args,_f1))),env_call(Env0,"env_lambdas",[Env0,_env,T221]),env_call(Env0,"generate_lambda",[Env0,_s1,_prefix,T221,_module]),string_concat("eq(_",_name,T225),dynamic_add(T225,",",T224),dynamic_add(T224,_s1,T223),dynamic_add(T223,")",T222),eq(_code,T222),env_call(Env0,"extract_type_args",[Env0,_args,_type,_env]),env_call(Env0,"env_push",[Env0,_env,fcVar(_name,"local", '[|]'("Relation",_type)),_env_a]),env_call(Env0,"env_push_lambda",[Env0,_env_a,fcRel("",_args,_f1),_env2]));((eq(_f,fcPred(_name,_args,_info))),env_call(Env0,"extract_args",[Env0,_args,_sargs,_env,_env_a,_prefix,_module]),(((env_call(Env0,"env_get_var",[Env0,_env,_name,_fvar])),env_call(Env0,"compare_relation",[Env0,_fvar,_args,_env_a,_env2,_info]),(((eq(_fvar,fcVar(_,"local",_))),env_call(Env0,"make_local_string",[Env0,_prefix,_name,_sargs,_code]));((eq(_fvar,fcVar(_,"args",_))),env_call(Env0,"make_local_string",[Env0,_prefix,_name,_sargs,_code]));(env_call(Env0,"make_this_string",[Env0,_prefix,_name,_sargs,_code]))));(string_concat("cannot find relation ",_name,T226),env_call(Env0,"custom_throw",[Env0,T226,_info]))));((eq(_f,fcObjPred(_obj,_name,_args,_info))),(((eq(_obj,"this")),env_call(Env0,"extract_args",[Env0,_args,_sargs,_env,_env_a,_prefix,_module]),(((env_call(Env0,"env_get_var",[Env0,_env,_name,_fvar])),env_call(Env0,"compare_relation",[Env0,_fvar,_args,_env_a,_env2,_info]),env_call(Env0,"make_this_string",[Env0,_prefix,_name,_sargs,_code]));(string_concat("cannot find relation ",_name,T227),env_call(Env0,"custom_throw",[Env0,T227,_info]))));((((env_call(Env0,"find_lib",[Env0,_env,_obj])),env_call(Env0,"extract_args",[Env0,_args,_sargs,_env,_env_a,_prefix,_module]),(((env_call(Env0,"env_get_types",[Env0,_env,_obj,_ts]),neq(_ts,[])),(((env_call(Env0,"_env_get_var",[Env0,_ts,_name,_fvar])),env_call(Env0,"compare_relation",[Env0,_fvar,_args,_env_a,_env2,_info]));(string_concat("cannot find relation ",_name,T230),dynamic_add(T230," in module ",T229),dynamic_add(T229,_obj,T228),env_call(Env0,"custom_throw",[Env0,T228,_info]))));(eq(_env2,_env))),dynamic_add(_prefix,"obj_call2(Env0,\"",T239),dynamic_add(T239,_obj,T238),dynamic_add(T238,"\",",T237),dynamic_add(T237,"\"",T236),dynamic_add(T236,_name,T235),dynamic_add(T235,"\",",T234),dynamic_add(T234,"[",T233),dynamic_add(T233,_sargs,T232),dynamic_add(T232,"])",T231),eq(_code,T231));(string_concat("cannot find module \"",_obj,T241),dynamic_add(T241,"\"",T240),env_call(Env0,"custom_throw",[Env0,T240,_info]))))));((eq(_f,fcCond(_a,_b,_l))),env_call(Env0,"generate_body",[Env0,_a,_sa,_env,_env_a,_module]),env_call(Env0,"generate_body",[Env0,_b,_sb,_env_a,_env_b,_module]),env_call(Env0,"generate_cond",[Env0,_l,_scond,_env_b,_env2,_module]),string_concat("((",_sa,T245),dynamic_add(T245,"),",T244),dynamic_add(T244,_sb,T243),dynamic_add(T243,")",T242),eq(_code1,T242),string_concat("(",_code1,T249),dynamic_add(T249,";",T248),dynamic_add(T248,_scond,T247),dynamic_add(T247,")",T246),eq(_code,T246));((eq(_f,fcSoftCut(_a,_b,_l))),env_call(Env0,"generate_body",[Env0,_a,_sa,_env,_env_a,_module]),env_call(Env0,"generate_body",[Env0,_b,_sb,_env_a,_env_b,_module]),env_call(Env0,"generate_cond",[Env0,_l,_scond,_env_b,_env2,_module]),string_concat("(",_sa,T255),dynamic_add(T255,")->(",T254),dynamic_add(T254,_sb,T253),dynamic_add(T253,")",T252),dynamic_add(T252,";",T251),dynamic_add(T251,_scond,T250),eq(_code1,T250),string_concat("(",_code1,T257),dynamic_add(T257,")",T256),eq(_code,T256));((eq(_f,fcTrue)),eq(_env2,_env),eq(_code,"true"));((eq(_f,fcFalse)),eq(_env2,_env),eq(_code,"false"));((eq(_f,fcOnce(_a))),env_call(Env0,"generate_body",[Env0,_a,_s1,_env,_env2,_module]),string_concat("once(",_s1,T259),dynamic_add(T259,")",T258),eq(_code,T258));((eq(_f,fcDeclaration(_name,_type))),(((eq(_type, '[|]'("FunctorObject",_))),env_call(Env0,"env_push",[Env0,_env,fcVar(_name,"local",_type),_env_a]),env_call(Env0,"env_push_functor",[Env0,_env_a,fcVar(_name,"",'[|]'("Functor",[])),_env2]),eq(_code,"true"));(env_call(Env0,"env_push",[Env0,_env,fcVar(_name,"local",_type),_env2]),eq(_code,"true"))));((eq(_f,fcHost("pl",_name,_args))),env_call(Env0,"extract_args",[Env0,_args,_sargs,_env,_env2,_prefix,_module]),dynamic_add(_prefix,_name,T263),dynamic_add(T263,"(",T262),dynamic_add(T262,_sargs,T261),dynamic_add(T261,")",T260),eq(_code,T260))).
gen_generate_world(Env0,_f,_code,_env1,_env2,_module) :- (((eq(_f,fcAnd(_a,_b))),env_call(Env0,"generate_world",[Env0,_a,_s1,_env1,_temp_env,_module]),env_call(Env0,"generate_world",[Env0,_b,_s2,_temp_env,_env2,_module]),dynamic_add(_s1,_s2,T264),eq(_code,T264));((eq(_f,fcEq(_a,_b))),env_call(Env0,"extract_name",[Env0,_a,_sa,_env,_,_,_module]),env_call(Env0,"extract_name",[Env0,_b,_sb,_env,_,_,_module]),env_call(Env0,"env_push",[Env0,_env1,fcVar(_sa,_sb,'[|]'("Any",[])),_env2]),eq(_code,""));((eq(_f,fcRel(_name,_args,_f1))),env_call(Env0,"extract_type_args_and_push_into_env",[Env0,_args,_type,_env1,_env_fn]),eq(_fvar,fcVar(_name,"object", '[|]'("Relation",_type))),dynamic_add(_module,"_",T266),dynamic_add(T266,_name,T265),eq(_sname,T265),env_call(Env0,"env_push",[Env0,_env_fn,_fvar,T267]),env_call(Env0,"stringfy_rel",[Env0,_sname,_args,_f1,_code,T267,_lambdas,_module]),env_call(Env0,"env_push",[Env0,_env1,_fvar,_env_a]),env_call(Env0,"env_set_lambdas",[Env0,_env_a,_lambdas,_env2]));((eq(_f,fcFact(_name,_args,_info))),(((eq(_name,"require")),eq(_args, '[|]'(fcStr(_arg0), '[|]'(fcId(_arg1,_),_))),obj_call2(Env0,"string","size",[_arg0,_len]),obj_call2(Env0,"math","sub",[_len,1,_n]),obj_call2(Env0,"string","slice",[_arg0,1,_n,_arg_module]),dynamic_add(_arg_module,".pl",T268),eq(_fname,T268),string_concat(":- ensure_loaded(\"",_fname,T270),dynamic_add(T270,"\").\n",T269),eq(_code,T269),env_call(Env0,"env_push",[Env0,_env1,fcLib(_arg_module,_arg1),_env_a]),env_call(Env0,"extract_type_information",[Env0,_fname,_type_info]),env_call(Env0,"env_push_module",[Env0,_env_a,_arg1,_type_info,_env2]));((eq(_name,"functor")),eq(_code,""),eq(_args, '[|]'(fcId(_arg0,_), '[|]'(fcId(_arg1,_arg2),[]))),(((eq(_arg2,[])),eq(_type,'[|]'(_arg1,[])));(obj_call2(Env0,"list","concat",[_arg2,'[|]'('[|]'(_arg1,[]),[]),_type]))),eq(_type, '[|]'(_first_type,_)),(((neq(_first_type,"Functor")),string_concat("type \"",_first_type,T272),dynamic_add(T272,"\" is not a \"Functor\"",T271),env_call(Env0,"custom_throw",[Env0,T271,_info]));true),env_call(Env0,"env_push",[Env0,_env1,fcVar(_arg0,"object",'[|]'("FunctorObject",[])),_env_a]),env_call(Env0,"env_push_functor",[Env0,_env_a,fcVar(_arg0,"",_type),_env2]));(env_call(Env0,"custom_throw",[Env0,"only the relations 'require' and 'functor' are accepted here",_info]))));((eq(_f,fcDeclaration(_name,_type))),env_call(Env0,"env_push",[Env0,_env1,fcVar(_name,"object",_type),_env2]),eq(_code,""));(obj_call2(Env0,"logic","throw",["this code broke the compiler"]))).
gen_make_bind(Env0,_v,_i,_s,_module) :- (((eq(_v,fcVar(_a,_b,_))),dynamic_add(_module,"_",T274),dynamic_add(T274,_a,T273),eq(_name,T273),obj_call2(Env0,"math","integerToString",[_i,T284]),string_concat(",set(X",T284,T283),dynamic_add(T283,",",T282),dynamic_add(T282,"\"",T281),dynamic_add(T281,_a,T280),dynamic_add(T280,"\",",T279),dynamic_add(T279,_name,T278),dynamic_add(T278,",X",T277),fd_add(_i,1,T286),obj_call2(Env0,"math","integerToString",[T286,T285]),dynamic_add(T277,T285,T276),dynamic_add(T276,")",T275),eq(_s,T275));(eq(_v,fcLib(_name,_id)),obj_call2(Env0,"math","integerToString",[_i,_si]),string_concat(",",_name,T298),dynamic_add(T298,"_env(Y",T297),dynamic_add(T297,_si,T296),dynamic_add(T296,"),set(X",T295),dynamic_add(T295,_si,T294),dynamic_add(T294,",\"",T293),dynamic_add(T293,_id,T292),dynamic_add(T292,"\",Y",T291),dynamic_add(T291,_si,T290),dynamic_add(T290,",X",T289),fd_add(_i,1,T300),obj_call2(Env0,"math","integerToString",[T300,T299]),dynamic_add(T289,T299,T288),dynamic_add(T288,")",T287),eq(_s,T287))).
gen_make_binds(Env0,_l,_i,_i2,_s,_module) :- (((eq(_l,[])),eq(_i,_i2),eq(_s,""));(eq(_l, '[|]'(_a,_tail)),obj_call2(Env0,"math","add",[_i,1,_j]),env_call(Env0,"make_bind",[Env0,_a,_i,_s1,_module]),env_call(Env0,"make_binds",[Env0,_tail,_j,_i2,_s2,_module]),obj_call2(Env0,"string","concat",[_s1,_s2,_s]))).
gen_make_runtime_binds(Env0,_l,_i,_i2,_s,_module) :- (((eq(_l,[])),eq(_i,_i2),eq(_s,""));(eq(_l, '[|]'(_a,_tail)),obj_call2(Env0,"math","add",[_i,1,_j]),env_call(Env0,"make_bind",[Env0,_a,_i,_s1,_module]),env_call(Env0,"make_runtime_binds",[Env0,_tail,_j,_i2,_s2,_module]),string_concat("assert(",_s1,T303),dynamic_add(T303,_s2,T302),dynamic_add(T302,")",T301),eq(_s,T301))).
gen_serialize_item(Env0,_f,_s) :- (((eq(_f,fcVar(_name,"object",_type))),dynamic_add(_name," ",T305),obj_call2(Env0,"types","type_to_string",[_type,T306]),dynamic_add(T305,T306,T304),eq(_s,T304));(eq(_s,""))).
gen_notblank(Env0,_s) :- neq(_s,"").
gen_generate_chunk(Env0,_f,_code,_module,_opts) :- eq(_stdlibs,'[|]'(fcLib("list","list"),'[|]'(fcLib("string","string"),'[|]'(fcLib("math","math"),'[|]'(fcLib("io","io"),'[|]'(fcLib("logic","logic"),[])))))),eq(_stdvars,'[|]'(fcVar("Some","local",'[|]'("FunctorObject",[])),'[|]'(fcVar("None","local",'[|]'("FunctorObject",[])),'[|]'(fcVar("Left","local",'[|]'("FunctorObject",[])),'[|]'(fcVar("Right","local",'[|]'("FunctorObject",[])),[]))))),eq(_stdfcs,'[|]'(fcVar("Some","",'[|]'("Functor",'[|]'('[|]'("Any",[]),[]))),'[|]'(fcVar("None","",'[|]'("Functor",'[|]'('[|]'("Null",[]),[]))),[]))),(((obj_call2(Env0,"list","has",[_opts,"--no-std-libs"])),env_call(Env0,"env_init",[Env0,_env,_stdvars,_stdfcs,[]]));(obj_call2(Env0,"list","concat",[_stdlibs,_stdvars,T307]),env_call(Env0,"env_init",[Env0,_env0,T307,_stdfcs,[]]),env_call(Env0,"extract_modules",[Env0,_env0,'[|]'("list",'[|]'("string",'[|]'("math",'[|]'("io",'[|]'("logic",[]))))),_env]))),env_call(Env0,"generate_world",[Env0,_f,_code_world,_env,_env2,_module]),env_call(Env0,"env_vars",[Env0,_env2,T308]),env_call(Env0,"make_binds",[Env0,T308,0,_j,_s,_module]),env_call(Env0,"env_lambdas",[Env0,_env2,_lambdas]),obj_call2(Env0,"list","size",[_lambdas,T310]),fd_sub(T310,1,T309),env_call(Env0,"make_lambdas",[Env0,_lambdas,_l_lambdas,T309,_env2,_module]),env_get(Env0,"notblank",T318),env_get(Env0,"serialize_item",T317),env_call(Env0,"env_vars",[Env0,_env2,T316]),obj_call2(Env0,"list","map",[T316,closure(T317,Env0),T315]),obj_call2(Env0,"list","filter",[T315,closure(T318,Env0),T314]),obj_call2(Env0,"list","join",[T314,";",T313]),string_concat("%",T313,T312),dynamic_add(T312,"\n",T311),eq(_info,T311),string_concat("",_module,T323),dynamic_add(T323,"_env(X) :- new(X0)",T322),dynamic_add(T322,_s,T321),dynamic_add(T321,",X=X",T320),obj_call2(Env0,"math","integerToString",[_j,T324]),dynamic_add(T320,T324,T319),eq(_code_env,T319),string_concat(_info,":- style_check([-singleton,-no_effect]), ensure_loaded(\"core.pl\").\n",T329),obj_call2(Env0,"list","join",[_l_lambdas,"",T330]),dynamic_add(T329,T330,T328),dynamic_add(T328,_code_world,T327),dynamic_add(T327,_code_env,T326),dynamic_add(T326,".",T325),eq(_code,T325).
gen_generate_query(Env0,_f,_code,_prefix,_query_vars,_module) :- env_call(Env0,"env_init",[Env0,_env_a,'[|]'(fcVar("main","object",'[|]'("Relation",[])),'[|]'(fcLib("list","list"),'[|]'(fcLib("string","string"),'[|]'(fcLib("math","math"),'[|]'(fcLib("io","io"),'[|]'(fcLib("logic","logic"),'[|]'(fcVar("Some","local",'[|]'("FunctorObject",[])),'[|]'(fcVar("None","local",'[|]'("FunctorObject",[])),'[|]'(fcVar("Left","local",'[|]'("FunctorObject",[])),'[|]'(fcVar("Right","local",'[|]'("FunctorObject",[])),[])))))))))),'[|]'(fcVar("Some","",'[|]'("Functor",'[|]'('[|]'("Any",[]),[]))),'[|]'(fcVar("None","",'[|]'("Functor",'[|]'('[|]'("Null",[]),[]))),[])),[]]),env_call(Env0,"extract_modules",[Env0,_env_a,'[|]'("list",'[|]'("string",'[|]'("math",'[|]'("io",'[|]'("logic",[]))))),_env_b]),(((eq(_module,"temp")),eq(_env,_env_b));(env_call(Env0,"extract_module",[Env0,_module,_ts]),env_get(Env0,"env_push",T331),obj_call2(Env0,"list","fold",[_ts,closure(T331,Env0),_env_b,_env]))),env_call(Env0,"generate_body",[Env0,_f,_s1,_env,_env2,_module]),env_call(Env0,"env_vars",[Env0,_env2,T332]),obj_call2(Env0,"list","filter",[T332,closure(gen0,Env0),_xx1]),obj_call2(Env0,"list","map",[_xx1,closure(gen1,Env0),_xx2]),list_to_set(_xx2,_query_vars),env_call(Env0,"env_vars",[Env0,_env2,T333]),env_call(Env0,"make_binds",[Env0,T333,0,_j,_s,_module]),string_concat("",_module,T339),dynamic_add(T339,"_env(X) :- new(X0)",T338),dynamic_add(T338,_s,T337),dynamic_add(T337,",X=X",T336),obj_call2(Env0,"math","integerToString",[_j,T340]),dynamic_add(T336,T340,T335),dynamic_add(T335,".\n",T334),eq(_prefix0,T334),env_call(Env0,"env_lambdas",[Env0,_env2,_lambdas]),obj_call2(Env0,"list","size",[_lambdas,T342]),fd_sub(T342,1,T341),env_call(Env0,"make_lambdas",[Env0,_lambdas,_l_temp_functions,T341,_env2,_module]),obj_call2(Env0,"list","join",[_l_temp_functions,"",_prefix1]),string_concat(_prefix0,_prefix1,T343),eq(_prefix,T343),string_concat(_module,"_env(Env0),",T347),dynamic_add(T347,"(",T346),dynamic_add(T346,_s1,T345),dynamic_add(T345,")",T344),eq(_code,T344).
gen_env(X) :- new(X0),set(X0,"generate_query",gen_generate_query,X1),set(X1,"generate_chunk",gen_generate_chunk,X2),set(X2,"notblank",gen_notblank,X3),set(X3,"serialize_item",gen_serialize_item,X4),set(X4,"make_runtime_binds",gen_make_runtime_binds,X5),set(X5,"make_binds",gen_make_binds,X6),set(X6,"make_bind",gen_make_bind,X7),set(X7,"generate_world",gen_generate_world,X8),set(X8,"generate_body",gen_generate_body,X9),set(X9,"specialize_args",gen_specialize_args,X10),set(X10,"specialize_type",gen_specialize_type,X11),set(X11,"generate_cond",gen_generate_cond,X12),set(X12,"stringfy_rel",gen_stringfy_rel,X13),set(X13,"make_runtime_temps",gen_make_runtime_temps,X14),set(X14,"make_lambdas",gen_make_lambdas,X15),set(X15,"make_lambda",gen_make_lambda,X16),set(X16,"generate_body",gen_generate_body,X17),set(X17,"stringfy_rel",gen_stringfy_rel,X18),set(X18,"extract_list",gen_extract_list,X19),set(X19,"extract_type_args_and_push_into_env",gen_extract_type_args_and_push_into_env,X20),set(X20,"extract_type_args",gen_extract_type_args,X21),set(X21,"extract_args",gen_extract_args,X22),set(X22,"extract_type",gen_extract_type,X23),set(X23,"extract_name",gen_extract_name,X24),set(X24,"generate_lambda",gen_generate_lambda,X25),set(X25,"extract_list",gen_extract_list,X26),set(X26,"extract_ids",gen_extract_ids,X27),set(X27,"extract_id",gen_extract_id,X28),set(X28,"escape_double_quotes",gen_escape_double_quotes,X29),set(X29,"is_relation",gen_is_relation,X30),set(X30,"is_functor",gen_is_functor,X31),set(X31,"is_type",gen_is_type,X32),set(X32,"is_type2",gen_is_type2,X33),set(X33,"make_this_string",gen_make_this_string,X34),set(X34,"make_local_string",gen_make_local_string,X35),set(X35,"compare_functor",gen_compare_functor,X36),set(X36,"compare_relation",gen_compare_relation,X37),set(X37,"id_var",gen_id_var,X38),set(X38,"is_id",gen_is_id,X39),set(X39,"specialize_args",gen_specialize_args,X40),set(X40,"extract_args",gen_extract_args,X41),set(X41,"extract_type",gen_extract_type,X42),set(X42,"extract_type_args",gen_extract_type_args,X43),set(X43,"extract_modules",gen_extract_modules,X44),set(X44,"extract_module",gen_extract_module,X45),set(X45,"find_lib",gen_find_lib,X46),set(X46,"env_get",gen_env_get,X47),set(X47,"env_get_functor",gen_env_get_functor,X48),set(X48,"env_get_types",gen_env_get_types,X49),set(X49,"env_has_var",gen_env_has_var,X50),set(X50,"env_get_var",gen_env_get_var,X51),set(X51,"_env_get_mod",gen__env_get_mod,X52),set(X52,"_env_get_var",gen__env_get_var,X53),set(X53,"_env_get",gen__env_get,X54),set(X54,"env_push_module",gen_env_push_module,X55),set(X55,"env_set_lambdas",gen_env_set_lambdas,X56),set(X56,"env_push_lambda",gen_env_push_lambda,X57),set(X57,"env_push_functor",gen_env_push_functor,X58),set(X58,"env_push",gen_env_push,X59),set(X59,"env_modules",gen_env_modules,X60),set(X60,"env_lambdas",gen_env_lambdas,X61),set(X61,"env_functors",gen_env_functors,X62),set(X62,"env_vars",gen_env_vars,X63),set(X63,"env_init",gen_env_init,X64),set(X64,"extract_type_information",gen_extract_type_information,X65),set(X65,"extract",gen_extract,X66),set(X66,"gensym",gen_gensym,X67),set(X67,"custom_throw",gen_custom_throw,X68),types_env(Y68),set(X68,"types",Y68,X69),whitespacer_env(Y69),set(X69,"whitespacer",Y69,X70),parser_env(Y70),set(X70,"parser",Y70,X71),lexer_env(Y71),set(X71,"lexer",Y71,X72),set(X72,"Info",gen_Info,X73),set(X73,"Op",gen_Op,X74),set(X74,"TList",gen_TList,X75),set(X75,"Func",gen_Func,X76),set(X76,"ObjGet",gen_ObjGet,X77),set(X77,"Id",gen_Id,X78),set(X78,"Str",gen_Str,X79),set(X79,"Num",gen_Num,X80),set(X80,"Declaration",gen_Declaration,X81),set(X81,"Once",gen_Once,X82),set(X82,"Host",gen_Host,X83),set(X83,"SoftCut",gen_SoftCut,X84),set(X84,"Cond",gen_Cond,X85),set(X85,"If",gen_If,X86),set(X86,"ObjPred",gen_ObjPred,X87),set(X87,"Bracket",gen_Bracket,X88),set(X88,"Or",gen_Or,X89),set(X89,"And",gen_And,X90),set(X90,"Pred",gen_Pred,X91),set(X91,"False",gen_False,X92),set(X92,"True",gen_True,X93),set(X93,"Inequality",gen_Inequality,X94),set(X94,"Neq",gen_Neq,X95),set(X95,"Eq",gen_Eq,X96),set(X96,"Fact",gen_Fact,X97),set(X97,"Rel",gen_Rel,X98),set(X98,"Lib",gen_Lib,X99),set(X99,"Local",gen_Local,X100),set(X100,"Var",gen_Var,X101),list_env(Y101),set(X101,"list",Y101,X102),string_env(Y102),set(X102,"string",Y102,X103),math_env(Y103),set(X103,"math",Y103,X104),io_env(Y104),set(X104,"io",Y104,X105),logic_env(Y105),set(X105,"logic",Y105,X106),set(X106,"Some",gen_Some,X107),set(X107,"None",gen_None,X108),set(X108,"Left",gen_Left,X109),set(X109,"Right",gen_Right,X110),X=X110.